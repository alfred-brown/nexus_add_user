{
  "version": 4,
  "terraform_version": "1.0.2",
  "serial": 16,
  "lineage": "e991767f-e81a-3771-6f73-f2e9c02346a4",
  "outputs": {},
  "resources": [
    {
      "mode": "data",
      "type": "aws_db_instance",
      "name": "database",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "address": "test-database.cowqbdzhgjm5.us-west-1.rds.amazonaws.com",
            "allocated_storage": 100,
            "auto_minor_version_upgrade": true,
            "availability_zone": "us-west-1c",
            "backup_retention_period": 7,
            "ca_cert_identifier": "rds-ca-2019",
            "db_cluster_identifier": "",
            "db_instance_arn": "arn:aws:rds:us-west-1:608911059386:db:test-database",
            "db_instance_class": "db.t3.micro",
            "db_instance_identifier": "test-database",
            "db_instance_port": 0,
            "db_name": "",
            "db_parameter_groups": [
              "default.postgres11"
            ],
            "db_security_groups": [],
            "db_subnet_group": "default-vpc-6388ac04",
            "enabled_cloudwatch_logs_exports": [],
            "endpoint": "test-database.cowqbdzhgjm5.us-west-1.rds.amazonaws.com:5432",
            "engine": "postgres",
            "engine_version": "11.13",
            "hosted_zone_id": "Z10WI91S59XXQN",
            "id": "test-database",
            "iops": 3000,
            "kms_key_id": "",
            "license_model": "postgresql-license",
            "master_username": "postgres",
            "monitoring_interval": 60,
            "monitoring_role_arn": "arn:aws:iam::608911059386:role/rds-monitoring-role",
            "multi_az": false,
            "option_group_memberships": [
              "default:postgres-11"
            ],
            "port": 5432,
            "preferred_backup_window": "11:50-12:20",
            "preferred_maintenance_window": "sun:12:37-sun:13:07",
            "publicly_accessible": true,
            "replicate_source_db": "",
            "resource_id": "db-JA3C7U3R23AKCK3AQACNEITY6M",
            "storage_encrypted": false,
            "storage_type": "io1",
            "tags": {},
            "timezone": "",
            "vpc_security_groups": [
              "sg-8fac95f7"
            ]
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "aws_secretsmanager_secret_version",
      "name": "nessus",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:secretsmanager:us-west-1:608911059386:secret:nessus-db-password-N7Fzfv",
            "id": "arn:aws:secretsmanager:us-west-1:608911059386:secret:nessus-db-password-N7Fzfv|AWSCURRENT",
            "secret_binary": "",
            "secret_id": "arn:aws:secretsmanager:us-west-1:608911059386:secret:nessus-db-password-N7Fzfv",
            "secret_string": "{\n  \"username\": \"postgres\",\n  \"password\": \"kQqB0_Yisx8P5Fux\",\n  \"engine\": \"postgres\",\n  \"host\": \"test-database.cowqbdzhgjm5.us-west-1.rds.amazonaws.com:5432\",\n  \"port\": 5432,\n  \"dbClusterIdentifier\": \"test-database\"\n}\n",
            "version_id": "43020284-2619-4257-8AAC-3EB5FC79D93F",
            "version_stage": "AWSCURRENT",
            "version_stages": [
              "AWSCURRENT"
            ]
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_secretsmanager_secret",
      "name": "nessus",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:secretsmanager:us-west-1:608911059386:secret:nessus-db-password-N7Fzfv",
            "description": "",
            "force_overwrite_replica_secret": false,
            "id": "arn:aws:secretsmanager:us-west-1:608911059386:secret:nessus-db-password-N7Fzfv",
            "kms_key_id": "",
            "name": "nessus-db-password",
            "name_prefix": null,
            "policy": null,
            "recovery_window_in_days": 30,
            "replica": [],
            "rotation_enabled": false,
            "rotation_lambda_arn": "",
            "rotation_rules": [],
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_secretsmanager_secret_version",
      "name": "nessus",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:secretsmanager:us-west-1:608911059386:secret:nessus-db-password-N7Fzfv",
            "id": "arn:aws:secretsmanager:us-west-1:608911059386:secret:nessus-db-password-N7Fzfv|43020284-2619-4257-8AAC-3EB5FC79D93F",
            "secret_binary": "",
            "secret_id": "arn:aws:secretsmanager:us-west-1:608911059386:secret:nessus-db-password-N7Fzfv",
            "secret_string": "{\n  \"username\": \"postgres\",\n  \"password\": \"kQqB0_Yisx8P5Fux\",\n  \"engine\": \"postgres\",\n  \"host\": \"test-database.cowqbdzhgjm5.us-west-1.rds.amazonaws.com:5432\",\n  \"port\": 5432,\n  \"dbClusterIdentifier\": \"test-database\"\n}\n",
            "version_id": "43020284-2619-4257-8AAC-3EB5FC79D93F",
            "version_stages": [
              "AWSCURRENT"
            ]
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "secret_string"
              }
            ]
          ],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_secretsmanager_secret.nessus",
            "data.aws_db_instance.database",
            "random_password.rand_password"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "postgresql_grant_role",
      "name": "read_all",
      "provider": "provider[\"registry.terraform.io/cyrilgdn/postgresql\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "grant_role": "pg_read_all_settings",
            "id": "nessus_pg_read_all_settings_false",
            "role": "nessus",
            "with_admin_option": false
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "postgresql_role",
      "name": "nessus",
      "provider": "provider[\"registry.terraform.io/cyrilgdn/postgresql\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bypass_row_level_security": false,
            "connection_limit": -1,
            "create_database": false,
            "create_role": false,
            "encrypted": null,
            "encrypted_password": true,
            "id": "nessus",
            "idle_in_transaction_session_timeout": 0,
            "inherit": true,
            "login": true,
            "name": "nessus",
            "password": "{\n  \"username\": \"postgres\",\n  \"password\": \"kQqB0_Yisx8P5Fux\",\n  \"engine\": \"postgres\",\n  \"host\": \"test-database.cowqbdzhgjm5.us-west-1.rds.amazonaws.com:5432\",\n  \"port\": 5432,\n  \"dbClusterIdentifier\": \"test-database\"\n}\n",
            "replication": false,
            "roles": null,
            "search_path": null,
            "skip_drop_role": false,
            "skip_reassign_owned": false,
            "statement_timeout": 0,
            "superuser": false,
            "valid_until": "infinity"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "password"
              }
            ]
          ],
          "private": "bnVsbA==",
          "dependencies": [
            "data.aws_secretsmanager_secret_version.nessus"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_password",
      "name": "rand_password",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "none",
            "keepers": null,
            "length": 16,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "override_special": "_^%!",
            "result": "kQqB0_Yisx8P5Fux",
            "special": true,
            "upper": true
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    }
  ]
}
